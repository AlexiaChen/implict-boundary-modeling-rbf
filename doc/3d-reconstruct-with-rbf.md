

# 使用径向基函数（RBF）重建和表示三维物体

**J. C. Carr, R. K. Beatson, J. B. Cherrie, T. J. Mitchell, W. R. Fright, B. C. McCallum, T. R. Evans**

### 摘要

本文使用**多谐波径向基函数（Polyharmonic RBFs）**从点云数据重建光滑流形表面并修复不完整网格。物体的表面被隐式定义为拟合表面数据的 RBF 的零集。通过快速拟合和评估 RBF 的方法，我们能够处理包含数百万个点的单一 RBF 模型，这在以前是无法实现的。拟合过程中的**贪婪算法**减少了所需的中心点数量，实现了显著的数据压缩。多谐波样条的能量最小化特性产生了“最光滑”的插值，非常适合非均匀采样数据，能平滑填充孔洞并进行外推。对于噪声数据，采用非插值近似。该表示法本质上是实体模型，可解析地确定梯度和法线，有助于生成均匀网格。

---

### 1. 引言

插值不完整网格（填孔）和从 3D 扫描仪重建点云是图形学和 CAD 中的普遍问题。我们提出，使用 RBF 的隐式表示简化了这些问题并提供了统一框架。RBF 关联的表面可以在任何地方评估以产生所需分辨率的网格，其梯度和高阶导数可解析确定，且提取的等值面是流形的（不自交）。

此前，该技术受限于 $O(N^2)$ 的存储和 $O(N^3)$ 的运算复杂度。例如，直接拟合图 1(a) 中的龙需要 **3,000GB** 内存来存储矩阵。本文引入的快速方法使建模大型复杂物体成为可能。本文的主要贡献包括描述快速方法的计算优势、引入中心点减少技术、演示大型数据集建模、引入噪声数据处理的近似方法以及应用 RBF 进行网格修复。

#### 1.1 隐式表面

给定表面 $M$ 上的 $n$ 个不同点 $\{(x_i, y_i, z_i)\}_{i=1}^n$，寻找近似表面 $M'$。如果 $M$ 满足 $f(x,y,z)=0$，则称 $f$ 隐式定义了 $M$。与 CSG（构造实体几何）或分片代数表面不同，我们的目标是用一个**连续且可微的单一函数**对整个物体建模。这避免了分片拟合中的参数化问题，且能处理稀疏、非均匀采样的表面。

---

### 2. 将隐式函数拟合到表面

为避免 $f$ 恒为零的平凡解，需添加非零值的**离面（Off-surface）点**：
*   $f(x_i, y_i, z_i) = 0, \quad i = 1, \dots, n$（面内点）
*   $f(x_i, y_i, z_i) = d_i \neq 0, \quad i = n+1, \dots, N$（离面点）

通常选择**有符号距离函数**，外部点为正，内部点为负。离面点通过沿表面法线投影生成。如果法线方向模糊，可以不拟合法线，而依靠该点为零值的约束来固定函数。必须确保投影的离面点不会穿过表面的其他部分（即最近点仍应是生成它的那个点）。


### 3. 径向基函数插值

寻找插值函数 $s(\mathbf{x})$ 来近似有符号距离函数 $f(\mathbf{x})$。在 Beppo-Levi 空间 $BL^{(2)}(\mathbb{R}^3)$ 中，配备旋转不变半范数：
$$\|s\|^2 = \int_{\mathbb{R}^3} \left( \frac{\partial^2 s(\mathbf{x})}{\partial x^2} \right)^2 + \left( \frac{\partial^2 s(\mathbf{x})}{\partial y^2} \right)^2 + \dots + 2\left( \frac{\partial^2 s(\mathbf{x})}{\partial y \partial z} \right)^2 d\mathbf{x} \quad (4)$$
最光滑的插值函数具有以下形式：
$$s^*(\mathbf{x}) = p(\mathbf{x}) + \sum_{i=1}^N \lambda_i |\mathbf{x} - \mathbf{x}_i| \quad (5)$$
其中 $p$ 是线性多项式。对于 3D 拟合，双谐波（$\phi(r)=r$）和三谐波（$\phi(r)=r^3$）是理想选择。求解系数需要满足线性系统：
$$\begin{pmatrix} A & P \\ P^T & 0 \end{pmatrix} \begin{pmatrix} \lambda \\ \mathbf{c} \end{pmatrix} = \begin{pmatrix} \mathbf{f} \\ 0 \end{pmatrix} \quad (8)$$
由于直接法在 $N > 2,000$ 时由于存储和计算量过大而不可行，必须使用快速方法。

---

### 4. 快速方法
通过 **快速多极子方法（FMM）** 进行评估，利用远场和近场展开将 $M$ 个点的评估成本从 $O(MN)$ 降至 $O(M + N \log N)$。FMM 允许在预定精度内进行近似计算，极大地减少了计算时间。

---

### 5. RBF 中心点减少

通过**贪婪算法**迭代拟合，可以使用远少于原始数据点的中心点达到拟合精度。步骤如下：
1. 从节点子集开始拟合。
2. 计算所有节点的残差 $\epsilon_i = f_i - s(\mathbf{x}_i)$。
3. 若 $\max|\epsilon_i| < \text{拟合精度}$ 则停止。
4. 否则在残差大处添加新中心点，重复步骤 2。
例如，包含 544,000 个点的佛像仅需 80,000 个中心点即可达到 $1.4 \times 10^{-4}$ 的精度。

---

### 6. 噪声数据的 RBF 近似
针对噪声数据，最小化以下目标函数：
$$\min_{s \in BL^{(2)}(\mathbb{R}^3)} \rho \|s\|^2 + \frac{1}{N} \sum_{i=1}^N (s(\mathbf{x}_i) - f_i)^2 \quad (9)$$
参数 $\rho$ 平衡了函数的光滑度与对数据的忠实度。增加 $\rho$ 会增加 RBF 的“刚度”并提高平滑效果。

---

### 7. 表面评估与提取
物体表面是 $s(\mathbf{x}) = 0$ 的轨迹。我们使用优化的**表面跟随移动四面体（surface-following marching tetrahedra）**算法进行多边形化。该算法从 RBF 中心点开始播种，成本随分辨率平方增长，而非立方。

---

### 8. 结果
*   **计算规模：** 在 550MHz PIII 机器上，龙（43.7万点）拟合需约 2.8 小时，佛像（54.3万点）需 4 小时。
*   **内存：** 快速方法显著降低了 RAM 需求，佛像建模仅需 291MB 峰值内存，而直接法需要 4,700GB。
*   **网格修复：** RBF 能够平滑填充扫描数据中缺失的区域（如人像下巴或 statue 缺失的胸部）。
*   **压缩：** 龙的原始网格为 15.4MB，RBF 表示仅需 1.4MB。
*   **复杂拓扑：** 包含精密内部结构的涡轮叶片可用 594,000 个中心的单一 RBF 完美建模。

---

### 9. 总结与未来工作
快速方法使 RBF 表示复杂物体成为可能。RBF 尤其适用于处理非均匀采样和带孔洞的网格。未来工作包括改进减少算法的速度、利用并行处理以及将全局 RBF 分解为分片隐式表面贴片。

---

### 参考文献（部分）
* J. Duchon. Splines minimizing rotation-invariant semi-norms. 1977.
* L. Greengard and V. Rokhlin. A fast algorithm for particle simulations. 1987.
* W. E. Lorensen and H. E. Cline. Marching cubes. 1987.
